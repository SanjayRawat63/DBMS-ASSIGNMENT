/*
NAME :SANJAY RAWAT
ROLLNO:7341
*/
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package jdbc;

/**
 *
 * @author Sanjay Rawat
 */
import com.mongodb.DB;
import com.mongodb.DBCursor;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import java.util.Iterator;
import com.mongodb.client.model.Filters; 
import com.mongodb.client.model.Updates; 
import org.bson.Document;
import com.mongodb.MongoClient;
import com.mongodb.MongoCredential;
import com.mongodb.gridfs.GridFS;
import com.mongodb.gridfs.GridFSInputFile;
import java.io.File;
import java.io.IOException;
import java.util.Scanner;
public class Mongo {
    public static void main( String args[] ) throws IOException {
	
		
		MongoClient mongo = new MongoClient( "localhost" , 27017 );
		
	
		MongoCredential credential = MongoCredential.createCredential("SanjayRawat", "students", "password".toCharArray());
		System.out.println("Connected to the database successfully");	
                 Scanner sc=new Scanner(System.in);
      char ch;
      int choice,a;
      String s;
              do
		{   System.out.println("--------------------------------------------");
			System.out.println("1.For Text");
			System.out.println("2.For Image");
			System.out.println("3.For Audio");
			System.out.println("4.For Video");
                        System.out.println("5.Exit.");
			System.out.println("--------------------------------------------");
			System.out.println("Enter your Choice");
			a=sc.nextInt();
			switch(a){
                    case 1:
                        System.out.println("--------------------------------------------");
			System.out.println("1.Insert new Record");
			System.out.println("2.Display all Records");
			System.out.println("3.Update a Record");
			System.out.println("4.Delete a Record");
			System.out.println("--------------------------------------------");
			System.out.println("Enter your Choice");
			choice=sc.nextInt();
                        MongoDatabase database = mongo.getDatabase("Students");
                        MongoCollection collection = database.getCollection("STD_Record");
			 switch(choice){
				case 1: 
                                   int rollno,yr;
                                    String name,branch;
                                    System.out.println("Enter Student Rollno: ");
				    rollno=sc.nextInt();
				    System.out.println("Enter Student Name: ");
				    name=sc.next();
				    System.out.println("Enter Student Branch: ");
				    branch=sc.next();
                                    System.out.println("Enter Student Year: ");
				    yr=sc.nextInt();
                                    Document document = new Document("Rollno",rollno).append("Name",name).append("Branch",branch ).append("Year",yr);
                                    collection.insertOne(document);
                                    System.out.println("Inserted Successfully.....");
                                    break;
                                case 2:
                                
                                    FindIterable<Document> iterDoc = collection.find();
                                    int i = 1;
                                    Iterator it = iterDoc.iterator();
                                    while (it.hasNext()) {
                                            System.out.println(it.next());
                                            i++;
                                    }
                                
                                    break;
                                case 3:
                                      int rn,y;
                                    String brh,nme;
                                    System.out.println("what do you want to udpdate:");
                                       System.out.println("1.Name"+"\n"+"2.Year"+"\n"+"3.Branch");
                                       System.out.println("Enter Your choice");
                                       int h =sc.nextInt();
                                       if(h==1)
                                       { 
                                       System.out.println("Enter Student Rollno whose name to be updated: ");
				       rn=sc.nextInt();
				       System.out.println("Enter Name: ");
				       nme=sc.next();
                                       collection.updateOne(Filters.eq("Rollno", rn), Updates.set("Name",nme));       
                                       System.out.println("Document update successfully...");  
                                       }
                                       if(h==2)
                                       { 
                                       System.out.println("Enter Student Rollno whose Year to be updated: ");
				       rn=sc.nextInt();
				       System.out.println("Enter Year: ");
				       y=sc.nextInt();
                                       collection.updateOne(Filters.eq("Rollno", rn), Updates.set("Year",y));       
                                       System.out.println("Document update successfully..."); 
                                       }
                                       if(h==3)
                                       { 
                                       System.out.println("Enter Student Rollno whose Branch to be updated: ");
				       rn=sc.nextInt();
				       System.out.println("Enter Branch: ");
				       brh=sc.next();
                                       collection.updateOne(Filters.eq("Rollno", rn), Updates.set("Branch",brh));       
                                       System.out.println("Document update successfully..."); 
                                       }
                                    break;
                                case 4:
                                     System.out.println("Delete by:");
                                       System.out.println("1.Rollno"+"\n"+"2.Name"+"\n"+"3.Year"+"\n"+"4.Branch");
                                       System.out.println("Enter Your choice");
                                       int c =sc.nextInt();
                                        if(c==1)
                                       {
                                       int r;
                                       System.out.println("Enter the Rollno:");
                                       r=sc.nextInt();
                                       collection.deleteOne(Filters.eq("Rollno",r)); 
                                       System.out.println("Document deleted successfully...");
                                       }                                     
                                       if(c==2)
                                       {
                                       String nm;
                                       System.out.println("Enter the Name:");
                                       nm=sc.next();
                                       collection.deleteOne(Filters.eq("Name",nm)); 
                                       System.out.println("Document deleted successfully..."); 
                                       }                                      
                                       if(c==3)
                                       {
                                       int year;
                                       System.out.println("Enter the Year:");
                                       year=sc.nextInt();
                                       collection.deleteOne(Filters.eq("Year",year)); 
                                        System.out.println("Document deleted successfully..."); 
                                       }
                                       if(c==4)
                                       {
                                       String br;
                                       System.out.println("Enter the Branch:");
                                       br=sc.next();
                                       collection.deleteOne(Filters.eq("Branch",br)); 
                                        System.out.println("Document deleted successfully..."); 
                                       }  
                                    break;
                         }
                         break;
                    case 2:
                      int flag;
                        do{
                       System.out.println("--------------------------------------------");
			System.out.println("1.Insert Image");
		        System.out.println("2.Display Image details");
                        System.out.println("3.Delete Image");
                        System.out.println("Enter your choice: ");
                        int b=sc.nextInt();
                        DB db = mongo.getDB("Students");
			
			GridFS gfsPhoto = new GridFS(db, "photo");
                        switch(b){
                       case 1:         
                        System.out.println("Enter the Image name: ");
                        String str=sc.next();
                        System.out.println("Enter the Image format: ");
                        String format=sc.next();
                        File imageFile = new File("C:\\"+str+format);
			GridFSInputFile gfsFile = gfsPhoto.createFile(imageFile);
			gfsFile.setFilename(str);
			gfsFile.save();
                          break;                               
                      case 2:
			DBCursor cursor = gfsPhoto.getFileList();
			while (cursor.hasNext()) {
				System.out.println(cursor.next());
		
                        }
                        break;
                      case 3:
                          System.out.println("Enter the Image name you want to delete: ");
                        String st=sc.next();
			gfsPhoto.remove(gfsPhoto.findOne(st));

			System.out.println("Done");
                        break;
                }
                        
                        System.out.println("If you want to continue press 1 else 0:");
                        flag=sc.nextInt();
                        }while(flag==1); 
                        break;
                    case 3:
                         int fg;
                        do{
                       System.out.println("--------------------------------------------");
			System.out.println("1.Insert Audio");
		        System.out.println("2.Display  Audio details");
                        System.out.println("3.Delete Audio");
                        System.out.println("Enter your choice: ");
                        int b=sc.nextInt();
                        DB db = mongo.getDB("Students");
			
			GridFS gfsAudio = new GridFS(db, "audio");
                        switch(b){
                       case 1:         
                        System.out.println("Enter the Audio name : ");
                        String str=sc.next();
                        System.out.println("Enter the Audio format: ");
                        String format=sc.next();
                        File AudioFile = new File("C:\\"+str+format);
			GridFSInputFile gfsFile = gfsAudio.createFile(AudioFile);
			gfsFile.setFilename(str);
			gfsFile.save();
                          break;                               
                      case 2:
			DBCursor cursor = gfsAudio.getFileList();
			while (cursor.hasNext()) {
				System.out.println(cursor.next());
		
                        }
                        break;
                      case 3:
                          System.out.println("Enter the Audio name you want to delete: ");
                        String st=sc.next();
			gfsAudio.remove(gfsAudio.findOne(st));

			System.out.println("Done");
                        break;
                }
                        
                        System.out.println("If you want to continue press 1 else 0:");
                        fg=sc.nextInt();
                        }while(fg==1); 
                        break;
                    case 4:
                        int f;
                        do{
                       System.out.println("--------------------------------------------");
			System.out.println("1.Insert Video");
		        System.out.println("2.Display  Video details");
                        System.out.println("3.Delete Video");
                        System.out.println("Enter your choice: ");
                        int b=sc.nextInt();
			DB db = mongo.getDB("Students");
			
			GridFS gfsVideo = new GridFS(db, "Video");
                        
                        switch(b){
                       case 1:         
                        System.out.println("Enter the Video name : ");
                        String str=sc.next();
                        System.out.println("Enter the Video format: ");
                        String format=sc.next();
                        File VideoFile = new File("C:\\"+str+format);
			GridFSInputFile gfsFile = gfsVideo.createFile(VideoFile);
			gfsFile.setFilename(str);
			gfsFile.save();
                          break;                               
                      case 2:
			DBCursor cursor = gfsVideo.getFileList();
			while (cursor.hasNext()) {
				System.out.println(cursor.next());
		
                        }
                        break;
                      case 3:
                          System.out.println("Enter the Video name you want to delete : ");
                        String st=sc.next();
			gfsVideo.remove(gfsVideo.findOne(st));

			System.out.println("Done");
                        break;
                }
                        
                        System.out.println("If you want to continue press 1 else 0:");
                        fg=sc.nextInt();
                        }while(fg==1); 
                        break;
                    case 5:
                        System.exit(0);
                }
                        System.out.println("Do you want to continue??(y/n):");
                         s=sc.next();
                         ch=s.charAt(0);
    
}while(ch=='y'||ch=='Y');
        }
 }
/*
OUTPUT=>
run:
Nov 03, 2020 9:56:56 AM com.mongodb.diagnostics.logging.JULLogger log
INFO: Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}
Connected to the database successfully
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
Nov 03, 2020 9:56:56 AM com.mongodb.diagnostics.logging.JULLogger log
INFO: Opened connection [connectionId{localValue:1, serverValue:74}] to localhost:27017
Nov 03, 2020 9:56:56 AM com.mongodb.diagnostics.logging.JULLogger log
INFO: Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, version=ServerVersion{versionList=[4, 4, 0]}, minWireVersion=0, maxWireVersion=9, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=5231800}
1
--------------------------------------------
1.Insert new Record
2.Display all Records
3.Update a Record
4.Delete a Record
--------------------------------------------
Enter your Choice
1
Enter Student Rollno: 
1
Enter Student Name: 
Sanjay
Enter Student Branch: 
Mech
Enter Student Year: 
3
Nov 03, 2020 9:57:10 AM com.mongodb.diagnostics.logging.JULLogger log
INFO: Opened connection [connectionId{localValue:2, serverValue:75}] to localhost:27017
Inserted Successfully.....
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
1
--------------------------------------------
1.Insert new Record
2.Display all Records
3.Update a Record
4.Delete a Record
--------------------------------------------
Enter your Choice
2
Document{{_id=5fa0dc1e0ceba319416dde6d, Rollno=1, Name=Sanjay, Branch=Mech, Year=3}}
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
1
--------------------------------------------
1.Insert new Record
2.Display all Records
3.Update a Record
4.Delete a Record
--------------------------------------------
Enter your Choice
3
what do you want to udpdate:
1.Name
2.Year
3.Branch
Enter Your choice
3
Enter Student Rollno whose Branch to be updated: 
1
Enter Branch: 
COMP
Document update successfully...
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
1
--------------------------------------------
1.Insert new Record
2.Display all Records
3.Update a Record
4.Delete a Record
--------------------------------------------
Enter your Choice
2
Document{{_id=5fa0dc1e0ceba319416dde6d, Rollno=1, Name=Sanjay, Branch=COMP, Year=3}}
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
1
--------------------------------------------
1.Insert new Record
2.Display all Records
3.Update a Record
4.Delete a Record
--------------------------------------------
Enter your Choice
4
Delete by:
1.Rollno
2.Name
3.Year
4.Branch
Enter Your choice
1
Enter the Rollno:
1
Document deleted successfully...
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
1
--------------------------------------------
1.Insert new Record
2.Display all Records
3.Update a Record
4.Delete a Record
--------------------------------------------
Enter your Choice
2
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
2
--------------------------------------------
1.Insert Image
2.Display Image details
3.Delete Image
Enter your choice: 
1
Enter the Image name: 
image
Enter the Image format: 
.jpg
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Image
2.Display Image details
3.Delete Image
Enter your choice: 
2
{ "filename" : "image" , "aliases" :  null  , "chunkSize" : 261120 , "uploadDate" : { "$date" : "2020-11-03T04:28:27.433Z"} , "length" : 4952565 , "_id" : { "$oid" : "5fa0dc6b0ceba319416dde6e"} , "contentType" :  null  , "md5" : "ad6528b4806e9483196ff8c26e311c11"}
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Image
2.Display Image details
3.Delete Image
Enter your choice: 
3
Enter the Image name you want to delete: 
image
Done
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Image
2.Display Image details
3.Delete Image
Enter your choice: 
2
If you want to continue press 1 else 0:
0
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
3
--------------------------------------------
1.Insert Audio
2.Display  Audio details
3.Delete Audio
Enter your choice: 
1
Enter the Audio name : 
audio
Enter the Audio format: 
.mp3
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Audio
2.Display  Audio details
3.Delete Audio
Enter your choice: 
2
{ "filename" : "audio" , "aliases" :  null  , "chunkSize" : 261120 , "uploadDate" : { "$date" : "2020-11-03T04:29:00.457Z"} , "length" : 200664 , "_id" : { "$oid" : "5fa0dc8c0ceba319416dde82"} , "contentType" :  null  , "md5" : "e0bde5023546992946a45705f5b7e57c"}
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Audio
2.Display  Audio details
3.Delete Audio
Enter your choice: 
3
Enter the Audio name you want to delete: 
audio
Done
If you want to continue press 1 else 0:
0
Do you want to continue??(y/n):
y
--------------------------------------------
1.For Text
2.For Image
3.For Audio
4.For Video
5.Exit.
--------------------------------------------
Enter your Choice
4
--------------------------------------------
1.Insert Video
2.Display  Video details
3.Delete Video
Enter your choice: 
1
Enter the Video name : 
nit
Enter the Video format: 
.mp4
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Video
2.Display  Video details
3.Delete Video
Enter your choice: 
2
{ "filename" : "nit" , "aliases" :  null  , "chunkSize" : 261120 , "uploadDate" : { "$date" : "2020-11-03T04:29:25.978Z"} , "length" : 12139799 , "_id" : { "$oid" : "5fa0dca50ceba319416dde84"} , "contentType" :  null  , "md5" : "9bb8f81d5e4e550686404f8fc4614d67"}
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Video
2.Display  Video details
3.Delete Video
Enter your choice: 
3
Enter the Video name you want to delete : 
nit
Done
If you want to continue press 1 else 0:
1
--------------------------------------------
1.Insert Video
2.Display  Video details
3.Delete Video
Enter your choice: 
2
If you want to continue press 1 else 0:
0
Do you want to continue??(y/n):
n
BUILD SUCCESSFUL (total time: 2 minutes 55 seconds)
*/